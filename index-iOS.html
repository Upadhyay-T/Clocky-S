<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8"/>
  <meta name="viewport" content="width=device-width, initial-scale=1, maximum-scale=1, user-scalable=no"/>
  <title>Clocky iOS</title>
  <style>
:root{
  --bg-grad-1:#0f0f14;
  --bg-grad-2:#1b2230;
  --card-bg: rgba(255,255,255,0.06);
  --card-border: rgba(255,255,255,0.12);
  --blur: 12px;
  --text:#e9eef7;
  --muted:#a8b0c3;
  --accent:#7aa2ff;
  --success:#22d3a6;
  --danger:#ff5c8a;
  --info:#5aa9ff;
  --ring: rgba(122,162,255,0.5);
  --radius:16px;
  --space:16px;
  --shadow: 0 1px 0 rgba(255,255,255,0.06) inset, 0 10px 30px rgba(0,0,0,0.35);
  --font: -apple-system, BlinkMacSystemFont, "SF Pro Text", "Segoe UI", Roboto, Helvetica, Arial, sans-serif;
}

*{box-sizing:border-box}
html,body{height:100%}
body{
  font-family: var(--font);
  background: radial-gradient(1200px 600px at 10% -10%, #1f2b46 0%, transparent 60%),
              radial-gradient(900px 700px at 110% 10%, #2b1f46 0%, transparent 60%),
              linear-gradient(135deg, var(--bg-grad-1), var(--bg-grad-2));
  color: var(--text);
  margin:0; padding: clamp(16px, 3vw, 32px);
  display:flex; align-items:center; justify-content:center;
}

.container{
  width:min(900px, 92vw);
  display:grid; gap: clamp(16px, 3vw, 24px);
}

header{
  display:flex; align-items:center; justify-content:space-between;
  gap:12px; padding: 4px 2px;
}
h1{
  margin:0; font-weight:700; letter-spacing:0.2px;
  font-size: clamp(22px, 3.4vw, 28px);
  background: linear-gradient(180deg, #fff, #9fb3ff);
  -webkit-background-clip:text; background-clip:text; color:transparent;
}
.mode{
  font-size: 14px; color: var(--muted);
}

.section{
  display:none;
  background: var(--card-bg);
  border: 1px solid var(--card-border);
  backdrop-filter: blur(var(--blur));
  -webkit-backdrop-filter: blur(var(--blur));
  border-radius: var(--radius);
  box-shadow: var(--shadow);
  padding: clamp(16px, 3.5vw, 28px);
}
.section.active{ display:block; animation: fadeIn 250ms ease-out }

.section h2{
  margin:0 0 12px 0;
  font-size: clamp(18px, 2.8vw, 22px);
  font-weight:650; color:#f2f5ff;
}

.controls, .stack{ display:flex; align-items:center; flex-wrap:wrap; gap:12px }
.stack{ flex-direction:column; align-items:center; gap:14px }

#sw-display{
  font-variant-numeric: tabular-nums;
  font-size: clamp(36px, 10vw, 56px);
  letter-spacing: 1px;
  padding: 4px 10px; border-radius: 10px;
  background: rgba(255,255,255,0.04);
}

select{
  appearance:none; -webkit-appearance:none;
  background: rgba(255,255,255,0.07);
  color: var(--text);
  border:1px solid var(--card-border);
  border-radius:12px;
  padding:10px 12px; font-size: 16px;
  box-shadow: 0 0 0 0 rgba(0,0,0,0);
  transition: border-color .2s, box-shadow .2s, transform .06s ease;
}
select:focus{ outline:none; border-color: var(--accent); box-shadow: 0 0 0 4px var(--ring) }

button{
  margin: 4px; padding: 12px 18px;
  border:1px solid var(--card-border); border-radius: 12px;
  font-weight: 700; font-size: 15px;
  color: #0d1220; cursor: pointer;
  transition: transform .06s ease, box-shadow .2s, filter .2s;
  box-shadow: 0 1px 0 rgba(255,255,255,0.15) inset, 0 8px 16px rgba(0,0,0,0.25);
}
button:hover{ transform: translateY(-1px) }
button:active{ transform: translateY(0) scale(0.98) }

.success{ background: linear-gradient(180deg, #25e1b0, #19b98f) }
.danger{ background: linear-gradient(180deg, #ff6a98, #e33d73); color:white }
.info{ background: linear-gradient(180deg, #7db4ff, #4f8dff); color:white }
button[style*="display:none"]{ display:none !important }

#sw-laps>div{
  background: rgba(255,255,255,0.04);
  border:1px solid var(--card-border);
  border-radius:10px; padding:8px 10px; margin-top:6px;
  font-variant-numeric: tabular-nums;
  color: var(--muted);
}

p, #tm-status, #alarm-status, #wx-status, #wx-box, #wx-place{
  color: var(--muted); margin: 6px 0 0 0;
  font-size: 14px;
}

@keyframes fadeIn{ from{opacity:0; transform: translateY(6px)} to{opacity:1; transform:none} }

@media (orientation: landscape){
  .container{ grid-template-columns: 1fr }
}

</style>
</head>
<body>

  <div class="container">
    <header>
      <h1>Clocky iOS</h1>
      <div class="mode">Rotate device to switch: Alarm ‚Ä¢ Stopwatch ‚Ä¢ Timer</div>
    </header>

  <!-- Alarm -->
  <div id="alarm" class="section active">
    <h2>‚è∞ Alarm</h2>
    <select id="alarm-hour"></select>:<select id="alarm-minute"></select><br><br>
    <button id="set-alarm" class="success">Set Alarm</button>
    <button id="cancel-alarm" class="danger" style="display:none">Cancel</button>
    <button id="dismiss-alarm" class="danger" style="display:none">Dismiss</button>
    <p id="alarm-status"></p>
  </div>

  <!-- Stopwatch + Weather -->
  <div id="stopwatch" class="section">
    <h2>‚è±Ô∏è Stopwatch</h2>
    <div id="sw-display">00:00.00</div>
    <button id="sw-start" class="success">Start</button>
    <button id="sw-stop" class="danger" style="display:none">Stop</button>
    <button id="sw-lap" class="info" style="display:none">Lap</button>
    <button id="sw-reset" style="display:none">Reset</button>
    <div id="sw-laps"></div>
    <h2>üå§Ô∏è Weather</h2>
    <div id="wx-status">Loading...</div>
    <div id="wx-box"></div>
    <div id="wx-place"></div>
    <button id="wx-refresh" class="info">Refresh</button>
  </div>

  <!-- Timer -->
  <div id="timer" class="section">
    <h2>‚è≤Ô∏è Timer</h2>
    <select id="tm-min"></select>:<select id="tm-sec"></select><br><br>
    <button id="tm-start" class="success">Start</button>
    <button id="tm-stop" class="danger" style="display:none">Stop</button>
    <button id="tm-reset" style="display:none">Reset</button>
    <button id="tm-dismiss" class="danger" style="display:none">Dismiss</button>
    <p id="tm-status"></p>
  </div>

</div>

<script>
(function(){
  const $=id=>document.getElementById(id);
  const pad2=n=>(n<10?'0':'')+n;

  /* -------- Chime -------- */
  let audioCtx, chimeInt, chimeTimeout;
  document.addEventListener('click', ()=>unlockAudio(), {once:true});
  function unlockAudio(){ const AC=window.AudioContext||window.webkitAudioContext; if(!audioCtx) audioCtx=new AC(); if(audioCtx.state==='suspended') audioCtx.resume(); }
  function startChime(){ stopChime(); unlockAudio(); if(!audioCtx) return;
    chimeInt=setInterval(()=>{ const o=audioCtx.createOscillator(),g=audioCtx.createGain(); o.type='sine'; o.frequency.value=880; o.connect(g); g.connect(audioCtx.destination); const t=audioCtx.currentTime; g.gain.setValueAtTime(0.3,t); g.gain.exponentialRampToValueAtTime(0.001,t+0.5); o.start(); o.stop(t+0.55); },1200);
    chimeTimeout=setTimeout(stopChime,30000);
  }
  function stopChime(){ if(chimeInt) clearInterval(chimeInt); if(chimeTimeout) clearTimeout(chimeTimeout); chimeInt=null; chimeTimeout=null; }

  /* -------- Notify -------- */
  async function notify(title,body){ if(Notification.permission!=='granted') await Notification.requestPermission(); if(Notification.permission==='granted') new Notification(title,{body}); else alert(title+"\\n"+body); }

  /* -------- Orientation (iOS) -------- */
  function updateView(){
    let angle=screen.orientation?screen.orientation.angle:window.orientation;
    let mode='portrait-up';
    if(angle===90) mode='landscape-right';    // Timer
    else if(angle===-90||angle===270) mode='landscape-left'; // Stopwatch
    else mode='portrait-up';                  // Alarm
    document.querySelectorAll('.section').forEach(s=>s.classList.remove('active'));
    if(mode==='portrait-up') $('alarm').classList.add('active');
    if(mode==='landscape-left') $('stopwatch').classList.add('active');
    if(mode==='landscape-right') $('timer').classList.add('active');
  }
  window.addEventListener('orientationchange', updateView);
  updateView();

  /* -------- Alarm -------- */
  for(let i=0;i<24;i++){ $('alarm-hour').add(new Option(pad2(i),i)); }
  for(let i=0;i<60;i++){ $('alarm-minute').add(new Option(pad2(i),i)); }
  let alarmTO;
  $('set-alarm').onclick=()=>{ let h=$('alarm-hour').value,m=$('alarm-minute').value; if(h===''||m===''){alert("Select time");return;} const now=new Date(),t=new Date(); t.setHours(h,m,0,0); if(t<=now) t.setDate(t.getDate()+1); let ms=t-now; clearTimeout(alarmTO); alarmTO=setTimeout(()=>{notify("‚è∞ Alarm","Time is up!"); startChime(); $('dismiss-alarm').style.display='inline-block';},ms); $('alarm-status').textContent="Alarm set for "+t.toLocaleTimeString(); $('set-alarm').style.display='none'; $('cancel-alarm').style.display='inline-block'; };
  $('cancel-alarm').onclick=()=>{ clearTimeout(alarmTO); $('alarm-status').textContent="Alarm cancelled"; $('set-alarm').style.display='inline-block'; $('cancel-alarm').style.display='none'; };
  $('dismiss-alarm').onclick=()=>{ stopChime(); $('dismiss-alarm').style.display='none'; };

  /* -------- Stopwatch -------- */
  let swRun=false, swStart=0, swAccum=0, swInt;
  function fmt(ms){const m=Math.floor(ms/60000),s=Math.floor((ms%60000)/1000),c=Math.floor((ms%1000)/10);return pad2(m)+":"+pad2(s)+"."+pad2(c);}
  function tick(){const e=swAccum+(swRun?(Date.now()-swStart):0); $('sw-display').textContent=fmt(e);}
  $('sw-start').onclick=()=>{swRun=true;swStart=Date.now();$('sw-start').style.display='none';$('sw-stop').style.display='inline-block';$('sw-lap').style.display='inline-block';swInt=setInterval(tick,100);}
  $('sw-stop').onclick=()=>{swRun=false;swAccum+=Date.now()-swStart;$('sw-start').style.display='inline-block';$('sw-stop').style.display='none';$('sw-lap').style.display='none';$('sw-reset').style.display='inline-block';clearInterval(swInt);}
  $('sw-reset').onclick=()=>{swRun=false;swAccum=0;$('sw-display').textContent='00:00.00';$('sw-laps').innerHTML='';$('sw-reset').style.display='none';}
  $('sw-lap').onclick=()=>{const e=swAccum+(swRun?(Date.now()-swStart):0);$('sw-laps').innerHTML+="<div>Lap "+($('sw-laps').children.length+1)+": "+fmt(e)+"</div>";}

  /* -------- Timer -------- */
  for(let i=0;i<=59;i++){ $('tm-min').add(new Option(pad2(i),i)); $('tm-sec').add(new Option(pad2(i),i)); }
  let tmInt, tmEnd;
  $('tm-start').onclick=()=>{const m=parseInt($('tm-min').value||0),s=parseInt($('tm-sec').value||0); if(m===0&&s===0){alert("Pick time");return;} tmEnd=Date.now()+(m*60+s)*1000; clearInterval(tmInt); tmInt=setInterval(tickTimer,250); $('tm-status').textContent="Timer running‚Ä¶"; $('tm-start').style.display='none'; $('tm-stop').style.display='inline-block';}
  $('tm-stop').onclick=()=>{clearInterval(tmInt);$('tm-status').textContent="Timer stopped";$('tm-start').style.display='inline-block';$('tm-stop').style.display='none';$('tm-reset').style.display='inline-block';}
  $('tm-reset').onclick=()=>{clearInterval(tmInt);$('tm-status').textContent="";$('tm-start').style.display='inline-block';$('tm-stop').style.display='none';$('tm-reset').style.display='none';$('tm-dismiss').style.display='none';$('tm-min').value="00";$('tm-sec').value="00";}
  function tickTimer(){const rem=Math.max(0,Math.round((tmEnd-Date.now())/1000));$('tm-status').textContent=pad2(Math.floor(rem/60))+":"+pad2(rem%60);if(rem<=0){clearInterval(tmInt);notify("‚è≤Ô∏è Timer","Finished!");startChime();$('tm-dismiss').style.display='inline-block';}}
  $('tm-dismiss').onclick=()=>{stopChime();$('tm-dismiss').style.display='none';}

  /* -------- Weather -------- */
  async function loadWeather(){if(!navigator.geolocation){$('wx-status').textContent="No geolocation";return;} navigator.geolocation.getCurrentPosition(async pos=>{const lat=pos.coords.latitude,lon=pos.coords.longitude;const res=await fetch(`https://api.open-meteo.com/v1/forecast?latitude=${lat}&longitude=${lon}&current_weather=true`);const data=await res.json();const cw=data.current_weather;$('wx-box').textContent=`${cw.temperature}¬∞C ¬∑ wind ${cw.windspeed} km/h`;const loc=await fetch(`https://geocoding-api.open-meteo.com/v1/reverse?latitude=${lat}&longitude=${lon}&language=en`);const ldata=await loc.json();if(ldata.results&&ldata.results)$('wx-place').textContent=ldata.results.name;},()=>{$('wx-status').textContent="Location denied";});}
  $('wx-refresh').onclick=loadWeather; loadWeather();
})();
</script>

</body>
</html>
